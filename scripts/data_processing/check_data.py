"""
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã
"""

import pandas as pd

print("="*80)
print("–ü–†–û–í–ï–†–ö–ê –î–ê–ù–ù–´–•")
print("="*80)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
df_all = pd.read_csv('ALL_DATA_COLLECTED.csv', encoding='utf-8-sig', low_memory=False)
print(f"\nüìÇ ALL_DATA_COLLECTED.csv")
print(f"   –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: {len(df_all):,}")

# –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
df_2025 = pd.read_csv('ALL_DATA_2025.csv', encoding='utf-8-sig', low_memory=False)
print(f"\nüìÇ ALL_DATA_2025.csv (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π)")
print(f"   –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: {len(df_2025):,}")

print(f"\n{'='*80}")
print("–ü–†–ò–ú–ï–†–´ –ù–û–ú–ï–†–û–í –ö–ê–†–¢:")
print(f"{'='*80}")

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
print(f"\nüìã –ò–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–ø–µ—Ä–≤—ã–µ 20 –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç):")
if '–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã' in df_all.columns:
    cards = df_all['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'].dropna().head(20)
    for idx, card in enumerate(cards, 1):
        print(f"{idx:2}. {card}")
elif '–ö–æ–¥ –∫–∞—Ä—Ç—ã' in df_all.columns:
    cards = df_all['–ö–æ–¥ –∫–∞—Ä—Ç—ã'].dropna().head(20)
    for idx, card in enumerate(cards, 1):
        print(f"{idx:2}. {card}")

print(f"\nüìã –ò–∑ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–ø–µ—Ä–≤—ã–µ 20 –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç):")
if '–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã' in df_2025.columns:
    cards = df_2025['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'].dropna().head(20)
    for idx, card in enumerate(cards, 1):
        print(f"{idx:2}. {card}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã
print(f"\n{'='*80}")
print("–ü–†–û–í–ï–†–ö–ê –ö–û–ù–ö–†–ï–¢–ù–û–ô –ö–ê–†–¢–´:")
print(f"{'='*80}")

if '–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã' in df_all.columns:
    sample_card = df_all['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'].dropna().iloc[0] if len(df_all['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'].dropna()) > 0 else None
    
    if sample_card:
        print(f"\nüîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ä—Ç—É: {sample_card}")
        
        # –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
        count_all = len(df_all[df_all['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'] == sample_card])
        print(f"   –í ALL_DATA_COLLECTED.csv: {count_all} –∑–∞–ø–∏—Å–µ–π")
        
        # –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–º
        count_2025 = len(df_2025[df_2025['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'] == sample_card])
        print(f"   –í ALL_DATA_2025.csv: {count_2025} –∑–∞–ø–∏—Å–µ–π")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–ø–∏—Å–∏
        if count_2025 > 0:
            print(f"\n   –ó–∞–ø–∏—Å–∏ –∏–∑ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:")
            records = df_2025[df_2025['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'] == sample_card][['–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã', '–°—Ç–∞—Ç—É—Å —Å–≤—è–∑–∏', '–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã', '–û–ø–µ—Ä–∞—Ç–æ—Ä']].head(5)
            print(records.to_string())

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
print(f"\n{'='*80}")
print("–ê–ù–ê–õ–ò–ó –î–ê–¢ –û–¢–ö–†–´–¢–ò–Ø:")
print(f"{'='*80}")

if '–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã' in df_all.columns:
    df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'] = pd.to_datetime(df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'], format='%d.%m.%Y %H:%M:%S', errors='coerce')
    
    valid_dates = df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'].notna().sum()
    print(f"\n–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π —Å –≤–∞–ª–∏–¥–Ω–æ–π –¥–∞—Ç–æ–π –æ—Ç–∫—Ä—ã—Ç–∏—è: {valid_dates:,} –∏–∑ {len(df_all):,}")
    
    if valid_dates > 0:
        print(f"\n–î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç:")
        print(f"  –°–∞–º–∞—è —Ä–∞–Ω–Ω—è—è: {df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'].min()}")
        print(f"  –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è: {df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'].max()}")
        
        # –ü–æ –≥–æ–¥–∞–º
        df_all['–ì–æ–¥'] = df_all['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'].dt.year
        print(f"\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥–æ–¥–∞–º:")
        year_counts = df_all['–ì–æ–¥'].value_counts().sort_index()
        for year, count in year_counts.items():
            if pd.notna(year):
                print(f"  {int(year)}: {count:,}")
        
        # –ü–æ –º–µ—Å—è—Ü–∞–º 2025
        df_2025_check = df_all[df_all['–ì–æ–¥'] == 2025]
        if len(df_2025_check) > 0:
            df_2025_check['–ú–µ—Å—è—Ü'] = df_all[df_all['–ì–æ–¥'] == 2025]['–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã'].dt.month
            print(f"\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –º–µ—Å—è—Ü–∞–º 2025 –≥–æ–¥–∞:")
            month_counts = df_2025_check['–ú–µ—Å—è—Ü'].value_counts().sort_index()
            months = {1: '–Ø–Ω–≤–∞—Ä—å', 2: '–§–µ–≤—Ä–∞–ª—å', 3: '–ú–∞—Ä—Ç', 4: '–ê–ø—Ä–µ–ª—å', 5: '–ú–∞–π', 6: '–ò—é–Ω—å',
                     7: '–ò—é–ª—å', 8: '–ê–≤–≥—É—Å—Ç', 9: '–°–µ–Ω—Ç—è–±—Ä—å', 10: '–û–∫—Ç—è–±—Ä—å', 11: '–ù–æ—è–±—Ä—å', 12: '–î–µ–∫–∞–±—Ä—å'}
            for month, count in month_counts.items():
                if pd.notna(month):
                    print(f"  {months.get(int(month), month)}: {count:,}")

print(f"\n{'='*80}")
print(f"–ò–¢–û–ì–û:")
print(f"  –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {len(df_all):,} –∑–∞–ø–∏—Å–µ–π")
print(f"  –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞ 2025: {len(df_2025):,} –∑–∞–ø–∏—Å–µ–π")
print(f"  –†–∞–∑–Ω–∏—Ü–∞ –≤ {len(df_all)/len(df_2025):.1f} —Ä–∞–∑")
