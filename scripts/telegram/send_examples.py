"""
–û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç—á–µ—Ç–æ–≤ –≤ Telegram
"""
import asyncio
from pathlib import Path
from telegram import Bot

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
TOKEN = '8141079204:AAErNrjLqTu4Vj1_7VS2kjGFKcR3lU9L9N4'
CHAT_ID = 2012682567

BASE_DIR = Path(__file__).parent.parent.parent
EXAMPLES_DIR = BASE_DIR / '–ü–†–ò–ú–ï–†–´_–û–¢–ß–ï–¢–û–í'

async def send_reports():
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç—á–µ—Ç–æ–≤"""
    bot = Bot(token=TOKEN)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    message = """
üìä <b>–ü–†–ò–ú–ï–†–´ –û–¢–ß–ï–¢–û–í –í EXCEL</b>

–û—Ç–ø—Ä–∞–≤–ª—è—é –≤–∞–º 7 –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç—á–µ—Ç–æ–≤:

1Ô∏è‚É£ <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –û–ü–ï–†–ê–¢–û–†–û–í</b> - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º
2Ô∏è‚É£ <b>–§–ò–î–ë–≠–ö–ò –û–¢ –°–õ–£–ñ–ë</b> - –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç —Å–ª—É–∂–± (3 –ª–∏—Å—Ç–∞)
3Ô∏è‚É£ <b>–û–¢–í–ï–¢–´ –ì–†–ê–ñ–î–ê–ù</b> - –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –≥—Ä–∞–∂–¥–∞–Ω
4Ô∏è‚É£ <b>–û–¢–ß–ï–¢ –ü–û –°–õ–£–ñ–ë–ï 102</b> - –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–ª—É–∂–±–µ
5Ô∏è‚É£ <b>–û–ë–©–ò–ô –û–¢–ß–ï–¢</b> - –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º —Å–ª—É–∂–±–∞–º
6Ô∏è‚É£ <b>–û–¢–ß–ï–¢ –ü–û –†–ï–ì–ò–û–ù–£</b> - –û—Ç—á–µ—Ç –ø–æ —Ä–µ–≥–∏–æ–Ω—É
7Ô∏è‚É£ <b>–ï–ñ–ï–î–ù–ï–í–ù–´–ô –û–¢–ß–ï–¢</b> - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç

üìù <b>–ß—Ç–æ –¥–µ–ª–∞—Ç—å:</b>
‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª—ã –≤ Excel
‚Ä¢ –í–Ω–µ—Å–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
‚Ä¢ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô_
‚Ä¢ –û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ

–§–∞–π–ª—ã –∏–¥—É—Ç –Ω–∏–∂–µ üëá
    """
    
    await bot.send_message(chat_id=CHAT_ID, text=message, parse_mode='HTML')
    print('‚úì –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ')
    
    # –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
    files = [
        '1_–°–¢–ê–¢–ò–°–¢–ò–ö–ê_–û–ü–ï–†–ê–¢–û–†–û–í.xlsx',
        '2_–§–ò–î–ë–≠–ö–ò_–û–¢_–°–õ–£–ñ–ë.xlsx',
        '3_–û–¢–í–ï–¢–´_–ì–†–ê–ñ–î–ê–ù.xlsx',
        '4_–û–¢–ß–ï–¢_–ü–û_–°–õ–£–ñ–ë–ï_102.xlsx',
        '5_–û–ë–©–ò–ô_–û–¢–ß–ï–¢.xlsx',
        '6_–û–¢–ß–ï–¢_–ü–û_–†–ï–ì–ò–û–ù–£.xlsx',
        '7_–ï–ñ–ï–î–ù–ï–í–ù–´–ô_–û–¢–ß–ï–¢.xlsx'
    ]
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª
    for i, filename in enumerate(files, 1):
        file_path = EXAMPLES_DIR / filename
        
        if file_path.exists():
            print(f'‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ {i}/7: {filename}...')
            
            with open(file_path, 'rb') as f:
                await bot.send_document(
                    chat_id=CHAT_ID,
                    document=f,
                    filename=filename,
                    caption=f"üìÑ –ü—Ä–∏–º–µ—Ä {i}/7: {filename.replace('.xlsx', '').replace('_', ' ')}"
                )
            
            print(f'‚úì –û—Ç–ø—Ä–∞–≤–ª–µ–Ω: {filename}')
            await asyncio.sleep(1)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏
        else:
            print(f'‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω: {filename}')
    
    # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    final_msg = """
‚úÖ <b>–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!</b>

üìã <b>–¢–∞–∫–∂–µ –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å —Ñ–∞–π–ª README.md</b> —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –æ—Ç—á–µ—Ç–∞.

üí¨ <b>–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:</b>
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª—ã –≤ Excel
2. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤, –ø–æ—Ä—è–¥–æ–∫, —Ñ–æ—Ä–º–∞—Ç)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô_
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –æ–±—Ä–∞—Ç–Ω–æ

–ò–ª–∏ –æ–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å! üëç
    """
    
    await bot.send_message(chat_id=CHAT_ID, text=final_msg, parse_mode='HTML')
    print('\n‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!')

if __name__ == '__main__':
    print('=' * 60)
    print('–û–¢–ü–†–ê–í–ö–ê –ü–†–ò–ú–ï–†–û–í –û–¢–ß–ï–¢–û–í –í TELEGRAM')
    print('=' * 60)
    print()
    
    asyncio.run(send_reports())
