# üìÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Google Apps Script + Python —á–µ—Ä–µ–∑ Google Docs API

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

Apps Script —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç–∞–±–ª–∏—Ü ‚Üí –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –µ–¥–∏–Ω—ã–π Google Docs ‚Üí Python —á–∏—Ç–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Google Sheets

**–ü–æ—á–µ–º—É —á–µ—Ä–µ–∑ Docs?**
- Apps Script –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (6 –º–∏–Ω—É—Ç)
- –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –ª—É—á—à–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ Python
- Google Docs - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
- –§–æ—Ä–º–∞—Ç JSON Lines - –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
QAyta skript/
‚îú‚îÄ‚îÄ docs_collector.gs          # Apps Script –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Docs
‚îú‚îÄ‚îÄ python_processor.py         # Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ credentials.json            # OAuth credentials (—Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ token.json                  # –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (—Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README_DOCS_INTEGRATION.md  # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Cloud Console

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
3. –í–∫–ª—é—á–∏—Ç–µ APIs:
   - Google Docs API
   - Google Sheets API
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **APIs & Services ‚Üí Credentials**
5. –°–æ–∑–¥–∞–π—Ç–µ **OAuth 2.0 Client ID** (—Ç–∏–ø: Desktop app)
6. –°–∫–∞—á–∞–π—Ç–µ JSON –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `credentials.json` –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Google Docs –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Docs](https://docs.google.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π –¥–æ–∫—É–º–µ–Ω—Ç
3. –ù–∞–∑–æ–≤–∏—Ç–µ: "–ê—Ä—Ö–∏–≤ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∏–∑ URL:
   ```
   https://docs.google.com/document/d/[–≠–¢–û–¢_ID_–°–ö–û–ü–ò–†–û–í–ê–¢–¨]/edit
   ```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Apps Script

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É Google –¢–∞–±–ª–∏—Ü—É —Å–æ —Å–ø–∏—Å–∫–æ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–†–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Üí Apps Script**
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª: `docs_collector.gs`
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ `docs_collector.gs`
5. **–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
   ```javascript
   var DOCS_ID = "–í–°–¢–ê–í–¨–¢–ï_ID_–î–û–ö–£–ú–ï–ù–¢–ê_–°–Æ–î–ê";
   ```
   –Ω–∞:
   ```javascript
   var DOCS_ID = "–≤–∞—à_—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_id";
   ```
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ (Ctrl+S)
7. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–∞–±–ª–∏—Ü—ã - –ø–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é "üìÑ Docs Collector"

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```powershell
   pip install -r requirements.txt
   ```

2. –û—Ç–∫—Ä–æ–π—Ç–µ `python_processor.py`

3. –ó–∞–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
   ```python
   DOCS_ID = "id_–¥–æ–∫—É–º–µ–Ω—Ç–∞_–∏–∑_—à–∞–≥–∞_2"
   SHEETS_ID = "id_—Ç–∞–±–ª–∏—Ü—ã_–¥–ª—è_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
   ```

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫

#### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (Apps Script):
1. –í Google –¢–∞–±–ª–∏—Ü–µ –æ—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é: **üìÑ Docs Collector**
2. –í—ã–±–µ—Ä–∏—Ç–µ: **üîÑ –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ Docs**
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (3-5 –º–∏–Ω—É—Ç –¥–ª—è ~50 –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤)

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Python):
```powershell
python python_processor.py
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
- –û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–æ—Å—Ç—É–ø
- –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `token.json`

---

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –í Google Docs (JSON Lines):

```json
{"operator":"–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω","sheet":"11.2024","card":"8600123456789012","status":"–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π","date":"01.11.2024 10:30:00"}
{"operator":"–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä","sheet":"11.2024","card":"8600987654321098","status":"–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π","date":"02.11.2024 14:15:30"}
```

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = –æ—Ç–¥–µ–ª—å–Ω–∞—è JSON –∑–∞–ø–∏—Å—å

### –ü–æ–ª—è –∑–∞–ø–∏—Å–∏:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|--------|
| `operator` | –§–ò–û –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ | "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω" |
| `sheet` | –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ (–º–µ—Å—è—Ü) | "11.2024" |
| `card` | –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã | "8600123456789012" |
| `status` | –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ | "–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π" |
| `date` | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è | "01.11.2024 10:30:00" |

---

## üîÑ Workflow (—Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. Apps Script (docs_collector.gs)                         ‚îÇ
‚îÇ     ‚îú‚îÄ –ß–∏—Ç–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏–∑ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"              ‚îÇ
‚îÇ     ‚îú‚îÄ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –∫–∞–∂–¥–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞                  ‚îÇ
‚îÇ     ‚îú‚îÄ –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º –∞—Ä—Ö–∏–≤–Ω—ã–º –ª–∏—Å—Ç–∞–º                     ‚îÇ
‚îÇ     ‚îú‚îÄ –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∫–æ–ª–æ–Ω–∫–∏ B-I)                          ‚îÇ
‚îÇ     ‚îî‚îÄ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ Google Docs –ø–æ—Å—Ç—Ä–æ—á–Ω–æ (JSON)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. Google Docs (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)                   ‚îÇ
‚îÇ     ‚îî‚îÄ –¢–µ–∫—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å JSON Lines                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. Python (python_processor.py)                            ‚îÇ
‚îÇ     ‚îú‚îÄ –ß–∏—Ç–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ Google Docs API                ‚îÇ
‚îÇ     ‚îú‚îÄ –ü–∞—Ä—Å–∏—Ç JSON –ø–æ—Å—Ç—Ä–æ—á–Ω–æ                                ‚îÇ
‚îÇ     ‚îú‚îÄ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:                                 ‚îÇ
‚îÇ     ‚îÇ   ‚îú‚îÄ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º                         ‚îÇ
‚îÇ     ‚îÇ   ‚îú‚îÄ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º                            ‚îÇ
‚îÇ     ‚îÇ   ‚îî‚îÄ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º                          ‚îÇ
‚îÇ     ‚îî‚îÄ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Google Sheets                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. Google Sheets (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)                              ‚îÇ
‚îÇ     ‚îú‚îÄ –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º"                      ‚îÇ
‚îÇ     ‚îú‚îÄ –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º"                         ‚îÇ
‚îÇ     ‚îî‚îÄ –õ–∏—Å—Ç "–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ª–∏–º–∏—Ç—ã

### Apps Script:
- **MAX_RECORDS_PER_RUN**: 10,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ –∑–∞–ø—É—Å–∫
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –¥–æ 6 –º–∏–Ω—É—Ç
- –†–∞–∑–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ Docs: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ 1 –ú–ë

### Python:
- –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏
- –°–∫–æ—Ä–æ—Å—Ç—å: ~10,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã

### Google API:
- –ö–≤–æ—Ç—ã: 300 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç–∞ (Docs API)
- –ö–≤–æ—Ç—ã: 500 –∑–∞–ø—Ä–æ—Å–æ–≤/100 —Å–µ–∫—É–Ω–¥ (Sheets API)

---

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Apps Script

### –§—É–Ω–∫—Ü–∏–∏ –≤ `docs_collector.gs`:

1. **collectAllDataToDocs()** - –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
   - –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ Google Docs

2. **collectOperatorData()** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
   - –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –∞—Ä—Ö–∏–≤–Ω—ã–º –ª–∏—Å—Ç–∞–º
   - –ß–∏—Ç–∞–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ B-I

3. **collectArchiveDataToDocs()** - –¢–æ–ª—å–∫–æ –∞—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –∏ "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü"

4. **collectCurrentStatsToDocs()** - –¢–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –°–æ–±–∏—Ä–∞–µ—Ç –∏–∑ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –∏ "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü"
   - –§–æ—Ä–º–∞—Ç: JSON —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

5. **clearDocsDocument()** - –û—á–∏—Å—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Docs

---

## üìä –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Python

### –§—É–Ω–∫—Ü–∏–∏ –≤ `python_processor.py`:

1. **authenticate()** - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
   - OAuth 2.0 flow
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

2. **read_docs_data()** - –ß—Ç–µ–Ω–∏–µ –∏–∑ Docs
   - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ü–∞—Ä—Å–∏–Ω–≥ JSON Lines

3. **process_data()** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
   - –ü–æ–¥—Å—á–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤

4. **write_to_sheets()** - –ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ –≤ Sheets
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
   - –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö

---

## üîç –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–æ—è–±—Ä—å 2024

1. **Apps Script —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:**
   ```javascript
   // –í –º–µ–Ω—é: üìÑ Docs Collector ‚Üí üîÑ –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
   // –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Google Docs:
   {"operator":"–ò–≤–∞–Ω–æ–≤","card":"8600111111111111","status":"–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π","date":"15.11.2024 09:00:00"}
   {"operator":"–ò–≤–∞–Ω–æ–≤","card":"8600222222222222","status":"–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π","date":"16.11.2024 11:30:00"}
   {"operator":"–ü–µ—Ç—Ä–æ–≤","card":"8600333333333333","status":"–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞","date":"20.11.2024 14:00:00"}
   // ... 10000 –∑–∞–ø–∏—Å–µ–π
   ```

2. **Python –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
   ```python
   # python python_processor.py
   # –†–µ–∑—É–ª—å—Ç–∞—Ç:
   # –ò–≤–∞–Ω–æ–≤: 1245 –∑–∞–ø–∏—Å–µ–π, 980 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç
   # –ü–µ—Ç—Ä–æ–≤: 890 –∑–∞–ø–∏—Å–µ–π, 710 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç
   # –ù–æ—è–±—Ä—å 2024: 2135 –∑–∞–ø–∏—Å–µ–π, 1690 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç
   ```

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Sheets:**
   ```
   –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º":
   –§–ò–û         | –í—Å–µ–≥–æ | –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö | –°—Ç–∞—Ç—É—Å—ã
   –ò–≤–∞–Ω–æ–≤      | 1245  | 980        | –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π: 650, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π: 595
   –ü–µ—Ç—Ä–æ–≤      | 890   | 710        | –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π: 450, –∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞: 440
   
   –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º":
   –ú–µ—Å—è—Ü   | –í—Å–µ–≥–æ | –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö | –û–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
   11.2024 | 2135  | 1690       | 2
   ```

---

## ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "–§–∞–π–ª credentials.json –Ω–µ –Ω–∞–π–¥–µ–Ω"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–π–¥–∏—Ç–µ –®–∞–≥ 1 –∏–∑ "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç"
2. –°–∫–∞—á–∞–π—Ç–µ credentials.json
3. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å `python_processor.py`

### –û—à–∏–±–∫–∞: "Access denied" –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ email –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ Test User –≤ Google Cloud Console
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: APIs & Services ‚Üí OAuth consent screen ‚Üí Test users

### –û—à–∏–±–∫–∞: "Document not found"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DOCS_ID - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ ID –¥–æ–∫—É–º–µ–Ω—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–µ —É–¥–∞–ª–µ–Ω)
3. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ –≤–∞—à–µ–º—É Google –∞–∫–∫–∞—É–Ω—Ç—É

### Apps Script: "–ù–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –≤ '–ù–∞—Å—Ç—Ä–æ–π–∫–∏'"
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ª–∏—Å—Ç "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç: –§–ò–û | ID —Ç–∞–±–ª–∏—Ü—ã | –°—Ç–∞—Ç—É—Å
3. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "–∞–∫—Ç–∏–≤–µ–Ω"

---

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –≤ Python:

```python
# –í —Ñ—É–Ω–∫—Ü–∏–∏ process_data() –¥–æ–±–∞–≤—å—Ç–µ:

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
status_distribution = defaultdict(int)
for record in records:
    status_distribution[record.get('status')] += 1

# –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –¥–Ω—è–º
daily_stats = defaultdict(lambda: {'count': 0, 'cards': set()})
for record in records:
    date_str = record.get('date', '')
    date_obj = datetime.strptime(date_str, '%d.%m.%Y %H:%M:%S')
    day_key = date_obj.strftime('%d.%m.%Y')
    daily_stats[day_key]['count'] += 1
    daily_stats[day_key]['cards'].add(record.get('card'))
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:

```python
# –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
from datetime import datetime, timedelta

one_month_ago = datetime.now() - timedelta(days=30)

filtered_records = [
    r for r in records 
    if datetime.strptime(r['date'], '%d.%m.%Y %H:%M:%S') > one_month_ago
]
```

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Google Docs API Documentation](https://developers.google.com/docs/api)
- [Google Sheets API Documentation](https://developers.google.com/sheets/api)
- [Python Google API Client](https://github.com/googleapis/google-api-python-client)
- [Apps Script Reference](https://developers.google.com/apps-script/reference)

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–∞—á–Ω–∏—Ç–µ —Å –º–∞–ª–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (2-3)
2. **–õ–æ–≥–∏:** –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ Apps Script (View ‚Üí Logs)
3. **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å:** –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–ø–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ credentials.json –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ batch-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Apps Script
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ Python –≤ –∫–æ–Ω—Å–æ–ª–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ ID –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤/—Ç–∞–±–ª–∏—Ü
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã API –≤ Google Cloud Console

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 01.12.2025  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot
