@echo off
chcp 65001 >nul
cls

echo ================================================================================
echo ‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –û–ë–ù–û–í–õ–ï–ù–ù–û–ô –°–ò–°–¢–ï–ú–´
echo ================================================================================
echo.
echo üìã –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:
echo    1. –í—Å–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –Ω–æ–≤—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä
echo    2. –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
echo    3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
echo    4. –ù–æ–≤—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
echo.
pause
cls

echo ================================================================================
echo üìù –®–ê–ì 1: –ü–†–û–í–ï–†–ö–ê –û–ë–ù–û–í–õ–ï–ù–ù–´–• –§–ê–ô–õ–û–í
echo ================================================================================
echo.

echo –ü—Ä–æ–≤–µ—Ä—è—é —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ä—ã–µ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä—ã...
findstr /S /I /C:"improved_collector.py" scripts\telegram\*.py scripts\automation\*.py 2>nul
if errorlevel 1 (
    echo ‚úÖ –ù–µ—Ç —Å—Å—ã–ª–æ–∫ –Ω–∞ improved_collector.py –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö
) else (
    echo ‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ä—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä
)

echo.
findstr /S /I /C:"daily_db_collector.py" scripts\automation\*.py 2>nul
if errorlevel 1 (
    echo ‚úÖ –ù–µ—Ç —Å—Å—ã–ª–æ–∫ –Ω–∞ daily_db_collector.py
) else (
    echo ‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ä—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä
)

echo.
echo –ü—Ä–æ–≤–µ—Ä—è—é –Ω–æ–≤—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä...
if exist "scripts\data_collection\sheets_to_db_collector.py" (
    echo ‚úÖ –ù–æ–≤—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä sheets_to_db_collector.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
) else (
    echo ‚ùå –û–®–ò–ë–ö–ê: –ù–æ–≤—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!
)

echo.
pause
cls

echo ================================================================================
echo ü§ñ –®–ê–ì 2: –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´ –ë–û–¢–ê
echo ================================================================================
echo.

tasklist /FI "IMAGENAME eq pythonw.exe" 2>nul | find /I "pythonw.exe" >nul
if not errorlevel 1 (
    echo ‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω (pythonw.exe –ø—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–µ–Ω)
    echo.
    echo üìä –ü—Ä–æ—Ü–µ—Å—Å—ã:
    tasklist /FI "IMAGENAME eq pythonw.exe" /FO TABLE
) else (
    echo ‚ùå –ë–æ—Ç –ù–ï –∑–∞–ø—É—â–µ–Ω
    echo.
    echo üí° –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
    echo    –ó–ê–ü–£–°–ö_–ë–û–¢.bat
)

echo.
pause
cls

echo ================================================================================
echo ‚è∞ –®–ê–ì 3: –ü–†–û–í–ï–†–ö–ê –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ì–û –û–ë–ù–û–í–õ–ï–ù–ò–Ø
echo ================================================================================
echo.

schtasks /Query /TN "GoogleSheets_HourlyUpdate" >nul 2>&1
if not errorlevel 1 (
    echo ‚úÖ –ó–∞–¥–∞—á–∞ GoogleSheets_HourlyUpdate —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    echo.
    schtasks /Query /TN "GoogleSheets_HourlyUpdate" /FO LIST | findstr /C:"–°–æ—Å—Ç–æ—è–Ω–∏–µ" /C:"–ó–∞–ø—É—Å—Ç–∏—Ç—å"
) else (
    echo ‚ùå –ó–∞–¥–∞—á–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ù–ï —Å–æ–∑–¥–∞–Ω–∞
    echo.
    echo üí° –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
    echo    –ü–û–õ–ù–ê–Ø_–ù–ê–°–¢–†–û–ô–ö–ê_–°–ò–°–¢–ï–ú–´.bat
)

echo.
pause
cls

echo ================================================================================
echo üß™ –®–ê–ì 4: –¢–ï–°–¢ –ù–û–í–û–ì–û –ö–û–õ–õ–ï–ö–¢–û–†–ê
echo ================================================================================
echo.
echo ‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –î–ª—è —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞ –Ω—É–∂–µ–Ω —Ñ–∞–π–ª config/credentials.json
echo    –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, —É–≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
echo.
pause

python scripts\data_collection\sheets_to_db_collector.py

echo.
echo ================================================================================
echo üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–†–û–í–ï–†–ö–ò
echo ================================================================================
echo.
echo –ï—Å–ª–∏ —É–≤–∏–¥–µ–ª–∏:
echo.
echo   ‚úÖ "–û–ë–ù–û–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û"
echo      ‚Üí –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–î–ï–ê–õ–¨–ù–û!
echo.
echo   ‚ö†Ô∏è  "credentials.json –Ω–µ –Ω–∞–π–¥–µ–Ω"
echo      ‚Üí –ù–æ—Ä–º–∞–ª—å–Ω–æ! –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Google API
echo      ‚Üí –°–º. –¥–æ–∫—É–º–µ–Ω—Ç: –ù–ê–°–¢–†–û–ô–ö–ê_GOOGLE_API.md
echo.
echo   ‚ùå "–¢–∞–±–ª–∏—Ü–∞ 'fixations' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
echo      ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python scripts\database\db_schema.py
echo.
echo ================================================================================
echo ‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê
echo ================================================================================
echo.
echo üìö –î–æ–∫—É–º–µ–Ω—Ç—ã:
echo    - –ö–†–ê–¢–ö–ê–Ø_–°–í–û–î–ö–ê_–û–ë–ù–û–í–õ–ï–ù–ò–Ø.md - —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
echo    - –û–ë–ù–û–í–õ–ï–ù–ò–ï_–õ–û–ì–ò–ö–ò_08_01_2026.md - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
echo    - –ù–ê–°–¢–†–û–ô–ö–ê_GOOGLE_API.md - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API
echo.
pause
