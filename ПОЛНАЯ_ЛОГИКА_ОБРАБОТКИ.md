# –ü–û–õ–ù–ê–Ø –õ–û–ì–ò–ö–ê –û–ë–†–ê–ë–û–¢–ö–ò –û–¢–ß–ï–¢–û–í

## üìã –û–ü–ò–°–ê–ù–ò–ï

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –æ—Ç—á–µ—Ç–æ–≤ (.xlsx) –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

---

## üéØ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ (10 –¢–†–ï–ë–û–í–ê–ù–ò–ô)

### 1Ô∏è‚É£ –£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É –î–∞—Ç–∞_112
- **–ü–æ—á–µ–º—É:** –≠—Ç–∞ –∫–æ–ª–æ–Ω–∫–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç “ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç

```python
df = df.drop(columns=['–î–∞—Ç–∞_112'])
```

### 2Ô∏è‚É£ –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ (–ø–æ –ù–ê–ó–í–ê–ù–ò–Ø–ú, –Ω–µ –ø–æ–∑–∏—Ü–∏—è–º!)
- **–ö—Ä–∏—Ç–∏—á–Ω–æ:** **–ù–ê–ó–í–ê–ù–ò–ï**, –∞ –Ω–µ –ø–æ–∑–∏—Ü–∏—è! –ü–æ–∑–∏—Ü–∏–∏ —É—Å–ª–æ–≤–Ω—ã –∏ –º–µ–Ω—è—é—Ç—Å—è.

**–£–¥–∞–ª—è–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏:**
- `“ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–≤–æ–Ω–∫–∞
- `–ë—Ä–∏–≥–∞–¥–∞–≥–∞ —É–∑–∞—Ç–∏–ª–≥–∞–Ω –≤–∞“õ—Ç` - –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –±—Ä–∏–≥–∞–¥–µ
- `“ö—û–Ω“ì–∏—Ä–æ“õ —è–∫—É–Ω–ª–∞–Ω–≥–∞–Ω –≤–∞“õ—Ç` - –≤—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–≤–æ–Ω–∫–∞
- `–°—Ç–∞—Ç—É—Å_112` - —Å—Ç–∞—Ä—ã–π —Å—Ç–∞—Ç—É—Å
- `“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∏–ª—É–≤—á–∏ –§.–ò.–®` - –§–ò–û –∑–≤–æ–Ω—è—â–µ–≥–æ
- `–¢–µ–ª–µ—Ñ–æ–Ω_112` - –Ω–æ–º–µ—Ä 112
- `–é–∑–∏ —Ä–∞–¥ —ç—Ç–≥–∞–Ω` - –æ—Ç–∫–∞–∑–∞–ª —Å–∞–º
- `–ï—Å—Ç—å_–∂–∞–ª–æ–±–∞` - —Ñ–ª–∞–≥ –∂–∞–ª–æ–±—ã (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –ñ–∞–ª–æ–±–∞ —Ç–µ–∫—Å—Ç)

**–°–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏:**
- `‚Ññ` - –Ω–æ–≤–∞—è, –Ω—É–º–µ—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- `“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç` - –¥–∞—Ç–∞/–≤—Ä–µ–º—è
- `–°–ª—É–∂–±–∞_112` - —Å–ª—É–∂–±–∞ (101, 102, 103, 104)
- `–°–∞–±–∞–±` - –ø—Ä–∏—á–∏–Ω–∞ –≤—ã–∑–æ–≤–∞
- `–ö–∞—Ä—Ç–∞_112` - –∫–∞—Ä—Ç–∞
- `–ò–Ω—Ü–∏–¥–µ–Ω—Ç_112` - ID –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
- `–û–ø–µ—Ä–∞—Ç–æ—Ä_112` - –æ–ø–µ—Ä–∞—Ç–æ—Ä
- `–†–µ–≥–∏–æ–Ω_112` - **–ö–†–ò–¢–ò–ß–ù–û** —Ä–µ–≥–∏–æ–Ω (–Ω–µ —É–¥–∞–ª—è—Ç—å!)
- `–†–∞–π–æ–Ω_112` - —Ä–∞–π–æ–Ω
- `–ú–∞–Ω–∑–∏–ª` - –∞–¥—Ä–µ—Å
- `“ö—û–Ω“ì–∏—Ä–æ“õ –∂–æ–π–∏` - –º–µ—Å—Ç–æ –∑–≤–æ–Ω–∫–∞
- `–¢–∞–≤—Å–∏—Ñ` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `–¢–µ–ª–µ—Ñ–æ–Ω_–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π` - **–ö–†–ò–¢–ò–ß–ù–û** –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä (–Ω–µ —É–¥–∞–ª—è—Ç—å!)
- `–ò–Ω—Ü–∏–¥–µ–Ω—Ç_112_norm` - –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç
- `–ñ–∞–ª–æ–±–∞` - —Ç–µ–∫—Å—Ç –∂–∞–ª–æ–±—ã (–æ—á–∏—â–µ–Ω–Ω—ã–π —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤)
- `–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏` - –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- `–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ` - —Ñ–ª–∞–≥ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ

```python
DELETE_COLUMNS = [
    '–î–∞—Ç–∞_112',
    '“ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏',
    '–ë—Ä–∏–≥–∞–¥–∞–≥–∞ —É–∑–∞—Ç–∏–ª–≥–∞–Ω –≤–∞“õ—Ç',
    '“ö—û–Ω“ì–∏—Ä–æ“õ —è–∫—É–Ω–ª–∞–Ω–≥–∞–Ω –≤–∞“õ—Ç',
    '–°—Ç–∞—Ç—É—Å_112',
    '“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∏–ª—É–≤—á–∏ –§.–ò.–®',
    '–¢–µ–ª–µ—Ñ–æ–Ω_112',
    '–é–∑–∏ —Ä–∞–¥ —ç—Ç–≥–∞–Ω',
    '–ï—Å—Ç—å_–∂–∞–ª–æ–±–∞'
]

df = df.drop(columns=[col for col in DELETE_COLUMNS if col in df.columns])
```

### 3Ô∏è‚É£ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –î–ê–¢–ï (–æ—Ç —Ä–∞–Ω–Ω–∏—Ö –∫ –ø–æ–∑–¥–Ω–∏–º)

```python
df['“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç'] = pd.to_datetime(df['“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç'], errors='coerce')
df = df.sort_values(by='“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç', ascending=True).reset_index(drop=True)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ - —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ –∑–≤–æ–Ω–∫–∏, –ø–æ—Å–ª–µ–¥–Ω–∏–µ - —Å–∞–º—ã–µ –Ω–æ–≤—ã–µ

### 4Ô∏è‚É£ –ù—É–º–µ—Ä–∞—Ü–∏—è - –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É ‚Ññ

**–ü–û–°–õ–ï —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏!** –ù–µ–ª—å–∑—è —Ä–∞–Ω—å—à–µ.

```python
df.insert(0, '‚Ññ', range(1, len(df) + 1))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
```
‚Ññ   –î–∞—Ç–∞/–í—Ä–µ–º—è            –°–ª—É–∂–±–∞   –†–µ–≥–∏–æ–Ω
1   2026-01-04 00:01:12   102      –§–ê–†“í–û–ù–ê
2   2026-01-04 00:01:19   102      –•–û–†–ê–ó–ú
3   2026-01-04 00:01:39   102      –¢–û–®–ö–ï–ù–¢
...
99999   2026-01-31 23:59:45   102   –ë–£–•–û–†–û
```

### 5Ô∏è‚É£ –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å—ã 1./2./3./4. –∏–∑ –∂–∞–ª–æ–±

**–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:** `2. –ù–µ –ø—Ä–∏–µ—Ö–∞–ª–∞ –±—Ä–∏–≥–∞–¥–∞ —Å–∫–æ—Ä–æ–π`  
**–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:** `–ù–µ –ø—Ä–∏–µ—Ö–∞–ª–∞ –±—Ä–∏–≥–∞–¥–∞ —Å–∫–æ—Ä–æ–π`

```python
import re

def clean_complaint_prefix(text):
    if pd.isna(text):
        return text
    text = str(text)
    # –£–¥–∞–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –∏ —Ü–∏—Ñ—Ä—É(1-4) —Å —Ç–æ—á–∫–æ–π
    text = re.sub(r'^\s*[1-4]\.\s*', '', text)
    return text

df['–ñ–∞–ª–æ–±–∞'] = df['–ñ–∞–ª–æ–±–∞'].apply(clean_complaint_prefix)
```

### 6Ô∏è‚É£ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

**–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –∂–∞–ª–æ–±—ã –ø–æ STATUS_COLUMN:**

```python
def classify_status(val):
    if pd.isna(val):
        return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
    
    text = str(val).strip().lower()
    
    # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ: —Å–æ–¥–µ—Ä–∂–∏—Ç "–ø–æ–ª–æ–∂"
    if '–ø–æ–ª–æ–∂' in text:
        return '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ'
    
    # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: —Å–æ–¥–µ—Ä–∂–∏—Ç "–æ—Ç—Ä–∏—Ü" –ò –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç "–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞"
    if '–æ—Ç—Ä–∏—Ü' in text and '–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞' not in text:
        return '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ'
    
    # –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å: —Å–æ–¥–µ—Ä–∂–∏—Ç –ª—é–±–æ–π –∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
    patterns = ['–Ω–µ —É–¥–∞–ª–æ—Å—å', '–Ω–µ–¥–æ–∑–≤–æ–Ω', '–Ω–µ –¥–æ–∑–≤–æ–Ω', '–Ω–µ –æ—Ç–≤–µ—Ç', '–∑–∞–Ω—è—Ç', '—Å–±—Ä–æ—Å']
    if any(pat in text for pat in patterns):
        return '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å'
    
    # –ó–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏–ª–∏ –ø—Ä–æ—á–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ
    if '–æ—Ç—Ä–∏—Ü' in text or '–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞' in text:
        return '–ü—Ä–æ—á–µ–µ'
    
    return '–ü—Ä–æ—á–µ–µ'
```

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:**
- ‚úÖ **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ** - text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç "–ø–æ–ª–æ–∂"
- ‚ùå **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ** - text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç "–æ—Ç—Ä–∏—Ü" **–ò –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç** "–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞"
- üìû **–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å** - text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç: "–Ω–µ —É–¥–∞–ª–æ—Å—å" OR "–Ω–µ–¥–æ–∑–≤–æ–Ω" OR "–Ω–µ –¥–æ–∑–≤–æ–Ω" OR "–Ω–µ –æ—Ç–≤–µ—Ç" OR "–∑–∞–Ω—è—Ç" OR "—Å–±—Ä–æ—Å"
- ‚ùì **–ü—Ä–æ—á–µ–µ** - –æ—Å—Ç–∞–ª—å–Ω–æ–µ
- üö´ **–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ** - –ø—É—Å—Ç–æ/NaN

### 7Ô∏è‚É£ –õ–∏—Å—Ç "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã" - —Ç–æ–ª—å–∫–æ –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï

**–§–∏–ª—å—Ç—Ä:** –æ—Å—Ç–∞–≤–ª—è–µ–º –¢–û–õ–¨–ö–û –∑–∞–ø–∏—Å–∏, –≥–¥–µ `classify_status(–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏) == '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ'`

```python
df_negative = df[df['–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏'].apply(lambda x: classify_status(x) == '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ')].copy()
df_negative = df_negative.reset_index(drop=True)
df_negative.insert(0, '‚Ññ', range(1, len(df_negative) + 1))
```

**–ò—Å—Ö–æ–¥–Ω—ã–µ 234,178 –∑–∞–ø–∏—Å–µ–π:**
- 112 —Ñ–∞–π–ª–æ–≤ January 2026
- –°–õ–£–ñ–ë–ê_101: 89 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
- –°–õ–£–ñ–ë–ê_102: 9,818 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
- –°–õ–£–ñ–ë–ê_103: 804 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
- –°–õ–£–ñ–ë–ê_104: 1,347 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö

### 8Ô∏è‚É£ –õ–∏—Å—Ç "–ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º" - –°–í–û–î–ö–ê

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
–†–µ–≥–∏–æ–Ω_112             | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∂–∞–ª–æ–± | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ | –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å | –í—Å–µ–≥–æ
–§–ê–†“í–û–ù–ê –í–ò–õ–û–Ø–¢–ò        | 5,234            | 234           | 1,234          | 18,000
–•–û–†–ê–ó–ú –í–ò–õ–û–Ø–¢–ò         | 3,456            | 156           | 1,567          | 12,000
...
```

**–õ–æ–≥–∏–∫–∞:**
1. –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ `–†–µ–≥–∏–æ–Ω_112`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ —Å—á–∏—Ç–∞–µ–º:
   - `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∂–∞–ª–æ–±` = –∫–æ–ª-–≤–æ –ù–ï –ø—É—Å—Ç—ã—Ö –≤ –∫–æ–ª–æ–Ω–∫–µ –ñ–∞–ª–æ–±–∞
   - `–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ` = –∫–æ–ª-–≤–æ –≥–¥–µ `classify_status(...) == '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ'`
   - `–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å` = –∫–æ–ª-–≤–æ –≥–¥–µ `classify_status(...) == '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å'`
   - `–í—Å–µ–≥–æ` = –æ–±—â–µ–µ –∫–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–≥–∏–æ–Ω–µ

### 9Ô∏è‚É£ –õ–∏—Å—Ç "–†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã" - PIVOT –¢–ê–ë–õ–ò–¶–ê

**–ò—Å—Ö–æ–¥–Ω–∞—è:**
```
–†–µ–≥–∏–æ–Ω_112      | –°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏
–§–ê–†“í–û–ù–ê         | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
–§–ê–†“í–û–ù–ê         | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ
–•–û–†–ê–ó–ú          | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
...
```

**PIVOT (—Ä–µ–≥–∏–æ–Ω—ã —Å–ª–µ–≤–∞, —Å—Ç–∞—Ç—É—Å—ã —Å–≤–µ—Ä—Ö—É):**
```
–†–µ–≥–∏–æ–Ω_112      | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ | –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å | –ü—Ä–æ—á–µ–µ | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ
–§–ê–†“í–û–ù–ê –í–ò–õ–û–Ø–¢–ò | 234           | 567           | 1,234          | 145    | 2
–•–û–†–ê–ó–ú –í–ò–õ–û–Ø–¢–ò  | 156           | 423           | 1,567          | 98     | 1
...
```

```python
import pandas as pd

pivot = df.groupby(['–†–µ–≥–∏–æ–Ω_112', '–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏']).size().unstack(fill_value=0)
```

### üîü –õ–∏—Å—Ç "–ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏"

**–õ–æ–≥–∏–∫–∞:** –ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–∏—Å—Ç—ã (–ø—Ä–æ—á–∏–µ/–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã)

```python
df_not_found = df[~df.index.isin(positive_indices + negative_indices)].copy()
```

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –í–´–•–û–î–ù–´–• –§–ê–ô–õ–û–í

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª (–°–õ–£–ñ–ë–ê_101.xlsx, –°–õ–£–ñ–ë–ê_102.xlsx –∏ —Ç.–¥.) —Å–æ–¥–µ—Ä–∂–∏—Ç **5 –ª–∏—Å—Ç–æ–≤:**

1. **–î–µ—Ç–∞–ª—å–Ω—ã–µ** - –≤—Å–µ –∑–∞–ø–∏—Å–∏ (—Å–æ –≤—Å–µ–º–∏ 17 –∫–æ–ª–æ–Ω–∫–∞–º–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è)
2. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã** - —Ç–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∂–∞–ª–æ–±—ã
3. **–ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º** - —Å–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
4. **–†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã** - PIVOT —Ç–∞–±–ª–∏—Ü–∞
5. **–ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏** - –Ω–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏

---

## üîß –ö–û–î –ù–ê –ü–ö (Python)

### 1Ô∏è‚É£ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
```bash
pip install pandas openpyxl
```

### 2Ô∏è‚É£ –°–∫—Ä–∏–ø—Ç: finalize_reports_complete.py

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å .xlsx —Ñ–∞–π–ª–∞–º–∏

### 3Ô∏è‚É£ –ó–∞–ø—É—Å–∫
```bash
# Windows
python finalize_reports_complete.py "reports\–°–ª—É–∂–±—ã –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∑–∞ –Ø–Ω–≤–∞—Ä—å –º–µ—Å—è—Ü 2026 –≥–æ–¥"

# Linux/Mac
python finalize_reports_complete.py "reports/–°–ª—É–∂–±—ã –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∑–∞ –Ø–Ω–≤–∞—Ä—å –º–µ—Å—è—Ü 2026 –≥–æ–¥"
```

### 4Ô∏è‚É£ –í—ã–≤–æ–¥
```
======================================================================
–§–ò–ù–ê–õ–¨–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –û–¢–ß–ï–¢–û–í
======================================================================

–ù–∞–π–¥–µ–Ω–æ 5 —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:
  ‚Ä¢ –°–õ–£–ñ–ë–ê_101_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-36-15.xlsx
  ‚Ä¢ –°–õ–£–ñ–ë–ê_102_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-36-19.xlsx
  ‚Ä¢ –°–õ–£–ñ–ë–ê_103_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-37-39.xlsx
  ‚Ä¢ –°–õ–£–ñ–ë–ê_104_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-38-08.xlsx
  ‚Ä¢ –û–ë–©–ò–ô_–û–¢–ß–ï–¢_–í–°–ï_–°–õ–£–ñ–ë–´_2026-02-04_07-39-29.xlsx

======================================================================
–û–±—Ä–∞–±–æ—Ç–∫—É: –°–õ–£–ñ–ë–ê_101_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-36-15.xlsx
======================================================================
‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ 5574 —Å—Ç—Ä–æ–∫, 25 –∫–æ–ª–æ–Ω–æ–∫

üìã –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏—Å—Ç–æ–≤:
  1Ô∏è‚É£ –õ–∏—Å—Ç '–î–µ—Ç–∞–ª—å–Ω—ã–µ'...
     ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ 5574 —Å—Ç—Ä–æ–∫
  2Ô∏è‚É£ –õ–∏—Å—Ç '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã'...
     ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ
  3Ô∏è‚É£ –õ–∏—Å—Ç '–ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º'...
     ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ
  4Ô∏è‚É£ –õ–∏—Å—Ç '–†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã'...
     ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ
  5Ô∏è‚É£ –õ–∏—Å—Ç '–ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏'...
     ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ

‚úÖ –°–õ–£–ñ–ë–ê_101_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-36-15.xlsx —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω!

... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã) ...

======================================================================
‚úÖ –ó–ê–í–ï–†–®–ï–ù–û: 5/5 —Ñ–∞–π–ª–æ–≤ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
======================================================================
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–ê–ü–ö–ò

```
Qayta_skript/
‚îú‚îÄ‚îÄ finalize_reports_complete.py      ‚Üê –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ requirements.txt                   ‚Üê pip dependencies
‚îú‚îÄ‚îÄ reports/
‚îÇ   ‚îî‚îÄ‚îÄ –°–ª—É–∂–±—ã –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∑–∞ –Ø–Ω–≤–∞—Ä—å –º–µ—Å—è—Ü 2026 –≥–æ–¥/
‚îÇ       ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_101_–ò–ù–¶–ò–î–ï–ù–¢–´_*.xlsx
‚îÇ       ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_102_–ò–ù–¶–ò–î–ï–ù–¢–´_*.xlsx
‚îÇ       ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_103_–ò–ù–¶–ò–î–ï–ù–¢–´_*.xlsx
‚îÇ       ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_104_–ò–ù–¶–ò–î–ï–ù–¢–´_*.xlsx
‚îÇ       ‚îú‚îÄ‚îÄ –û–ë–©–ò–ô_–û–¢–ß–ï–¢_–í–°–ï_–°–õ–£–ñ–ë–´_*.xlsx
‚îÇ       ‚îî‚îÄ‚îÄ –¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï/
‚îÇ           ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_101_–¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï_*.xlsx
‚îÇ           ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_102_–¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï_*.xlsx
‚îÇ           ‚îú‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_103_–¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï_*.xlsx
‚îÇ           ‚îî‚îÄ‚îÄ –°–õ–£–ñ–ë–ê_104_–¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï_*.xlsx
‚îî‚îÄ‚îÄ incoming_data/
    ‚îî‚îÄ‚îÄ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (.csv –∏–ª–∏ .xlsx)
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–æ–∑–∏—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫ –º–µ–Ω—è—é—Ç—Å—è
**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û! –ü–æ–∑–∏—Ü–∏–∏ —É—Å–ª–æ–≤–Ω—ã –∏ –º–µ–Ω—è—é—Ç—Å—è
df = df.drop([[3, 4, 5, 10, 11, 12, 18, 19, 24, 25]])
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û! –ù–∞–∑–≤–∞–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã
df = df.drop(columns=['–î–∞—Ç–∞_112', '“ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏', ...])
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù—É–º–µ—Ä–∞—Ü–∏—è —Ä–∞–Ω—å—à–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
# ‚ùå –ù–æ–º–µ—Ä–∞ –Ω–µ –±—É–¥—É—Ç –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
df.insert(0, '‚Ññ', range(1, len(df) + 1))
df = df.sort_values(by='–î–∞—Ç–∞')
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
# ‚úÖ –°–Ω–∞—á–∞–ª–∞ —Å–æ—Ä—Ç–∏—Ä—É–µ–º, –ø–æ—Ç–æ–º –Ω—É–º–µ—Ä—É–µ–º
df = df.sort_values(by='–î–∞—Ç–∞')
df.insert(0, '‚Ññ', range(1, len(df) + 1))
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –£–¥–∞–ª–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
**–ò—Å—Ö–æ–¥–Ω—ã–µ 25 –∫–æ–ª–æ–Ω–æ–∫:**
- 17 –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å
- 8 –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

**–ù–ï–õ–¨–ó–Ø —É–¥–∞–ª—è—Ç—å:**
- `–†–µ–≥–∏–æ–Ω_112` - –Ω—É–∂–µ–Ω –¥–ª—è —Å–≤–æ–¥–æ–∫
- `–°–ª—É–∂–±–∞_112` - –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –ø–æ —Å–ª—É–∂–±–∞–º
- `–¢–µ–ª–µ—Ñ–æ–Ω_–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π` - –Ω—É–∂–µ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- `–ò–Ω—Ü–∏–¥–µ–Ω—Ç_112` - –æ—Å–Ω–æ–≤–Ω–æ–π ID
- `–ñ–∞–ª–æ–±–∞` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
- `–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏` - –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

## üéì –ü–†–ò–ú–ï–† - –ü–û–õ–ù–´–ô –¶–ò–ö–õ

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞
```python
df = pd.read_excel('–°–õ–£–ñ–ë–ê_101.xlsx', sheet_name='–î–µ—Ç–∞–ª—å–Ω—ã–µ')
# Result: 5,574 —Å—Ç—Ä–æ–∫ √ó 25 –∫–æ–ª–æ–Ω–æ–∫
```

### –®–∞–≥ 2: –£–¥–∞–ª–µ–Ω–∏–µ –î–∞—Ç–∞_112
```python
df = df.drop(columns=['–î–∞—Ç–∞_112'])
# Result: 5,574 —Å—Ç—Ä–æ–∫ √ó 24 –∫–æ–ª–æ–Ω–æ–∫
```

### –®–∞–≥ 3: –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –∫–æ–ª–æ–Ω–æ–∫
```python
df = df.drop(columns=['“ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏', '–ë—Ä–∏–≥–∞–¥–∞–≥–∞ —É–∑–∞—Ç–∏–ª–≥–∞–Ω –≤–∞“õ—Ç', ...])
# Result: 5,574 —Å—Ç—Ä–æ–∫ √ó 16 –∫–æ–ª–æ–Ω–æ–∫
```

### –®–∞–≥ 4: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ + –ù—É–º–µ—Ä–∞—Ü–∏—è
```python
df = df.sort_values(by='“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç', ascending=True).reset_index(drop=True)
df.insert(0, '‚Ññ', range(1, len(df) + 1))
# Result: 5,574 —Å—Ç—Ä–æ–∫ √ó 17 –∫–æ–ª–æ–Ω–æ–∫ (—Å ‚Ññ –≤ –Ω–∞—á–∞–ª–µ)
```

### –®–∞–≥ 5: –û—á–∏—Å—Ç–∫–∞ –∂–∞–ª–æ–±
```python
df['–ñ–∞–ª–æ–±–∞'] = df['–ñ–∞–ª–æ–±–∞'].apply(clean_complaint_prefix)
# "2. –ù–µ –ø–æ–≤–µ–∑" ‚Üí "–ù–µ –ø–æ–≤–µ–∑"
```

### –®–∞–≥ 6: Cr√©ation –ª–∏—Å—Ç–æ–≤
```python
# –õ–∏—Å—Ç 1: –í—Å–µ –¥–∞–Ω–Ω—ã–µ
# –õ–∏—Å—Ç 2: –¢–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (—Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É)
# –õ–∏—Å—Ç 3: –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (groupby + count)
# –õ–∏—Å—Ç 4: PIVOT (—Ä–µ–≥–∏–æ–Ω—ã √ó —Å—Ç–∞—Ç—É—Å—ã)
# –õ–∏—Å—Ç 5: –û—Å—Ç–∞–ª—å–Ω–æ–µ
```

### –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```python
wb.save('–°–õ–£–ñ–ë–ê_101.xlsx')
```

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –î–õ–Ø –í–û–ü–†–û–°–û–í

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –Ω–∞–ø–∏—à–∏—Ç–µ:
- –ö–∞–∫–∞—è –æ—à–∏–±–∫–∞?
- –ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ?
- –ö–∞–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞?

–ë—É–¥—É –ø–æ–º–æ–≥–∞—Ç—å!

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-02-05  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
