╔════════════════════════════════════════════════════════════════════════════╗
║                    🤖 TELEGRAM БОТ - ШПАРГАЛКА                            ║
╚════════════════════════════════════════════════════════════════════════════╝

┌─ ЗАПУСК ────────────────────────────────────────────────────────────────┐
│                                                                          │
│  МЕНЮ_БОТА.bat          ← Интерактивное меню (РЕКОМЕНДУЕТСЯ)           │
│  test_bot.bat           ← Тестовый режим (видны логи)                   │
│  start_telegram_bot.bat ← Фоновый режим                                 │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ КОМАНДЫ В TELEGRAM ────────────────────────────────────────────────────┐
│                                                                          │
│  /start     → Главное меню с кнопками                                   │
│  /full      → ОБНОВИТЬ ДАННЫЕ + СОЗДАТЬ ОТЧЕТЫ (3-5 мин)               │
│  /stats     → Статистика БД                                             │
│                                                                          │
│  /update    → Только обновление данных (1-3 мин)                        │
│  /reports   → Только генерация отчетов (1-2 мин)                        │
│                                                                          │
│  /operators → Отчет по операторам (Excel)                               │
│  /feedback  → Фидбэки служб (Excel)                                     │
│  /service102→ Детальный отчет службы 102 (Excel)                        │
│  /service103→ Детальный отчет службы 103 (Excel)                        │
│  /service104→ Детальный отчет службы 104 (Excel)                        │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ТЕКСТОВЫЕ СООБЩЕНИЯ ───────────────────────────────────────────────────┐
│                                                                          │
│  "обнови"      → Запустит /full                                         │
│  "операторы"   → Отправит /operators                                    │
│  "статистика"  → Покажет /stats                                         │
│  "102"         → Отправит /service102                                   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ТИПИЧНЫЙ ПРОЦЕСС ──────────────────────────────────────────────────────┐
│                                                                          │
│  1. Запустить бот:         МЕНЮ_БОТА.bat → выбрать 1 или 2             │
│  2. Открыть Telegram:      Написать /start                              │
│  3. Обновить всё:          Кнопка "📋 Обновить + Отчеты"               │
│  4. Подождать:             3-5 минут                                    │
│  5. Получить отчет:        Нажать нужную кнопку                         │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ПРОВЕРКА РАБОТЫ ───────────────────────────────────────────────────────┐
│                                                                          │
│  check_bot_status.bat  → Работает ли бот?                               │
│  view_bot_logs.bat     → Последние 50 строк лога                        │
│  logs\telegram_bot.log → Полный лог                                     │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ УПРАВЛЕНИЕ БОТОМ ──────────────────────────────────────────────────────┐
│                                                                          │
│  start_telegram_bot.bat  → Запустить в фоне                             │
│  stop_telegram_bot.bat   → Остановить                                   │
│  restart_telegram_bot.bat→ Перезапустить                                │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ЧТО ДЕЛАЕТ КАЖДАЯ КОМАНДА ────────────────────────────────────────────┐
│                                                                          │
│  /update                                                                │
│    ├─ Запускает improved_collector.py                                   │
│    ├─ Подключается к Google Sheets                                      │
│    ├─ Фильтрует записи (столбец E заполнен)                            │
│    ├─ Сохраняет в fiksa_database.db                                     │
│    └─ Сообщает: "✅ Собрано записей: 1176"                             │
│                                                                          │
│  /reports                                                               │
│    ├─ Запускает analytics_reports.py                                    │
│    ├─ Читает данные из БД                                               │
│    ├─ Группирует и анализирует                                          │
│    ├─ Создает Excel файлы                                               │
│    └─ Сохраняет в reports/                                              │
│                                                                          │
│  /full                                                                  │
│    ├─ Выполняет /update                                                 │
│    ├─ Затем выполняет /reports                                          │
│    └─ Показывает статистику                                             │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ГДЕ СОХРАНЯЮТСЯ ОТЧЕТЫ ───────────────────────────────────────────────┐
│                                                                          │
│  reports/                                                               │
│  ├── analytics/                                                         │
│  │   ├── operator_stats.xlsx        (/operators)                        │
│  │   ├── service_feedback.xlsx      (/feedback)                         │
│  │   └── citizen_responses.xlsx                                         │
│  └── services/                                                          │
│      ├── service_102_detailed.xlsx  (/service102)                       │
│      ├── service_103_detailed.xlsx  (/service103)                       │
│      └── service_104_detailed.xlsx  (/service104)                       │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ВОЗМОЖНЫЕ ОШИБКИ ──────────────────────────────────────────────────────┐
│                                                                          │
│  "❌ Файл не найден"                                                    │
│     → Решение: Выполните /full или /reports                             │
│                                                                          │
│  "⏱ Превышено время ожидания"                                          │
│     → Решение: Проверьте интернет, попробуйте еще раз                  │
│                                                                          │
│  "❌ Скрипт не найден"                                                  │
│     → Решение: Проверьте наличие файлов в scripts/                     │
│                                                                          │
│  Бот не отвечает                                                        │
│     → Решение: check_bot_status.bat → restart_telegram_bot.bat          │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ БЫСТРЫЕ СЦЕНАРИИ ──────────────────────────────────────────────────────┐
│                                                                          │
│  УТРОМ (получить свежие данные):                                        │
│    1. test_bot.bat                                                      │
│    2. Telegram: /full                                                   │
│    3. Подождать 5 минут                                                 │
│    4. Telegram: /operators                                              │
│                                                                          │
│  СРОЧНО (быстрая проверка):                                             │
│    1. Telegram: /stats                                                  │
│                                                                          │
│  ОТЧЕТ ПО СЛУЖБЕ (уже есть данные):                                     │
│    1. Telegram: 102 (или /service102)                                   │
│                                                                          │
│  ПОЛНАЯ ПЕРЕУСТАНОВКА:                                                  │
│    1. stop_telegram_bot.bat                                             │
│    2. start_telegram_bot.bat                                            │
│    3. Telegram: /full                                                   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ КОНФИГУРАЦИЯ ──────────────────────────────────────────────────────────┐
│                                                                          │
│  Token:    8141079204:AAErNrjLqTu4Vj1_7VS2kjGFKcR3lU9L9N4               │
│  Chat ID:  2012682567                                                   │
│  БД:       data/fiksa_database.db                                       │
│  Отчеты:   reports/                                                     │
│  Логи:     logs/telegram_bot.log                                        │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

┌─ ЧЕКЛИСТ ПЕРЕД ЗАПУСКОМ ────────────────────────────────────────────────┐
│                                                                          │
│  [x] Python 3.11 установлен                                             │
│  [x] pip install -r requirements.txt выполнено                          │
│  [x] credentials.json существует                                        │
│  [x] token.json существует                                              │
│  [x] fiksa_database.db создана                                          │
│  [x] Telegram токен правильный                                          │
│  [x] Chat ID правильный                                                 │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════════════════════════╗
║  🚀 БЫСТРЫЙ СТАРТ: МЕНЮ_БОТА.bat → 1 → Telegram: /start → /full          ║
╚════════════════════════════════════════════════════════════════════════════╝
