@echo off
REM ========================================
REM   –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –≤ Windows
REM   –¢—Ä–µ–±—É–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
REM ========================================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞: —Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
    echo.
    echo –ù–∞–∂–º–∏—Ç–µ –ü–ö–ú –Ω–∞ —ç—Ç–æ—Ç —Ñ–∞–π–ª ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    pause
    exit /b 1
)

setlocal enabledelayedexpansion

REM –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /d %~dp0

echo ========================================
echo ‚öôÔ∏è  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞...
echo ========================================
echo.

REM –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
for %%A in (.) do set "CURRENT_DIR=%%~dpA"
set "BOT_SCRIPT=%CURRENT_DIR%–ó–ê–ü–£–°–ö_–ë–û–¢.bat"

echo üìÅ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: %CURRENT_DIR%
echo ü§ñ –°–∫—Ä–∏–ø—Ç: %BOT_SCRIPT%
echo.

REM –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –≤ Task Scheduler
echo –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ Task Scheduler...
echo.

REM –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –∑–∞–¥–∞—á—É –µ—Å–ª–∏ –µ—Å—Ç—å
schtasks /delete /tn "QAyta Bot" /f >nul 2>&1

REM –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É (–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã)
schtasks /create /tn "QAyta Bot" /tr "cmd /c %BOT_SCRIPT%" /sc onstart /ru SYSTEM /f

if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏
    pause
    exit /b 1
)

echo ‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
echo.
echo üéØ –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å:
echo    ‚Ä¢ –ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ü–ö
echo    ‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ 24/7
echo    ‚Ä¢ –ö–∞–∂–¥—ã–π —á–∞—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets
echo    ‚Ä¢ –î–∞–∂–µ –µ—Å–ª–∏ –ü–ö —Å–ø–∏—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–∏
echo.

REM –î–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–æ–Ω
echo ‚ö†Ô∏è  –í–ê–ñ–ù–û: –û—Ç–∫–ª—é—á–∏—Ç–µ —Å–ø—è—â–∏–π —Ä–µ–∂–∏–º –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã!
echo.
echo –í—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ —Å–µ–π—á–∞—Å? (Y/N)
set /p choice=
if /i "%choice%"=="Y" (
    echo –û—Ç–∫–ª—é—á–∞—é —Å–ø—è—â–∏–π —Ä–µ–∂–∏–º...
    powercfg /change standby-timeout-ac 0
    powercfg /change standby-timeout-dc 0
    echo ‚úÖ –°–ø—è—â–∏–π —Ä–µ–∂–∏–º –æ—Ç–∫–ª—é—á–µ–Ω
) else (
    echo –ü—Ä–æ–ø—É—â–µ–Ω–æ - –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –ø–æ–∑–∂–µ
)

echo.
echo ========================================
echo ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
echo ========================================
echo.
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞:
echo    1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å
echo    2. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
echo    3. –í Telegram –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start
echo    4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: logs\telegram_bot.log
echo.

pause

exit /b 0
