@echo off
chcp 65001 > nul
echo ========================================
echo üöÄ –í–ö–õ–Æ–ß–ï–ù–ò–ï –ê–í–¢–û–ó–ê–ü–£–°–ö–ê –ë–û–¢–ê
echo ========================================
echo.

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorLevel% NEQ 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
    echo.
    echo üëâ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ü–ö–ú ‚Üí "–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
    echo.
    pause
    exit /b 1
)

echo ‚úÖ –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã
echo.

:: –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ
set "PROJECT_PATH=%~dp0"
set "TASK_NAME=TelegramBot_AutoStart"

echo üìÇ –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É: %PROJECT_PATH%
echo.

:: –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞–Ω–∏–µ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ Windows
echo üìù –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ –∑–∞–¥–∞—á Windows...
echo.
schtasks /Create /TN "%TASK_NAME%" /TR "\"%PROJECT_PATH%–ó–ê–ü–£–°–ö_–ë–û–¢.bat\"" /SC ONLOGON /RL HIGHEST /F >nul 2>&1

if errorlevel 1 (
    echo ‚ùå –û–®–ò–ë–ö–ê –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è!
    echo.
    echo –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    echo - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    echo - –ó–∞–¥–∞–Ω–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    echo.
    echo –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
    echo 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    echo 2. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –û–°–¢–ê–ù–û–í–ò–¢–¨_–ë–û–¢.bat, –ø–æ—Ç–æ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å
    echo.
) else (
    echo ========================================
    echo ‚úÖ –ê–í–¢–û–ó–ê–ü–£–°–ö –£–°–ü–ï–®–ù–û –í–ö–õ–Æ–ß–ï–ù!
    echo ========================================
    echo.
    echo üîπ –ë–æ—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è:
    echo    - –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É
    echo    - –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
    echo.
    echo üîπ –ò–º—è –∑–∞–¥–∞–Ω–∏—è: %TASK_NAME%
    echo.
    echo üí° –ß—Ç–æ –¥–∞–ª—å—à–µ:
    echo    1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    echo    2. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é: –ó–ê–ü–£–°–ö_–ë–û–¢.bat
    echo.
    echo üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å: –ü–†–û–í–ï–†–ö–ê_–°–ò–°–¢–ï–ú–´.bat
    echo üõë –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫: –û–°–¢–ê–ù–û–í–ò–¢–¨_–ë–û–¢.bat
    echo.
)

pause
