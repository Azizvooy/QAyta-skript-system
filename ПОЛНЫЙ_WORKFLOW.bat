@echo off
REM =================================================================
REM  ПОЛНЫЙ WORKFLOW: ИМПОРТ-ОБРАБОТКА-ОТЧЕТЫ
REM =================================================================
REM  Этот файл запускает полный цикл обработки данных за один раз:
REM  1. Импорт данных из Google Sheets
REM  2. Обработка данных в PostgreSQL
REM  3. Генерация Excel отчетов с отрицательными отзывами
REM  
REM  Результаты сохраняются в папке: reports/YYYY-MM/ТОЛЬКО_ОТРИЦАТЕЛЬНЫЕ/
REM =================================================================

echo.
echo ================================================
echo    QAYTA - ПОЛНЫЙ WORKFLOW ОБРАБОТКИ ДАННЫХ
echo ================================================
echo.

cd /d "%~dp0"

REM Активируем виртуальное окружение
if exist .venv\Scripts\activate.bat (
    call .venv\Scripts\activate.bat
) else (
    echo ERROR: Виртуальное окружение не найдено!
    echo Пожалуйста, создайте его: python -m venv .venv
    pause
    exit /b 1
)

REM Запускаем полный workflow
echo.
echo Запуск полного workflow обработки данных...
echo.

python RUN_FULL_WORKFLOW.py

if %ERRORLEVEL% EQU 0 (
    echo.
    echo ================================================
    echo ✅  WORKFLOW ЗАВЕРШЕН УСПЕШНО
    echo ================================================
    echo.
    echo Отчеты сохранены в папке: reports\
    echo.
) else (
    echo.
    echo ================================================
    echo ❌  ОШИБКА ПРИ ВЫПОЛНЕНИИ WORKFLOW
    echo ================================================
    echo.
)

pause
