"""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                    –õ–û–ì–ò–ö–ê –û–ë–†–ê–ë–û–¢–ö–ò –û–¢–ß–ï–¢–û–í - –î–õ–Ø –ü–ö                      ‚ïë
‚ïë                                                                            ‚ïë
‚ïë  –≠—Ç–æ –ø–æ–ª–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –æ—Ç –ê –¥–æ –Ø                        ‚ïë
‚ïë  –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–∫ guide –¥–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –≤–∞—à–µ–º –ü–ö                      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
"""

# ============================================================================
# –ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï
# ============================================================================
"""
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (25 –∫–æ–ª–æ–Ω–æ–∫):

    ‚Ññ  –î–∞—Ç–∞_112  “ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª  –°–ª—É–∂–±–∞_112  –°–∞–±–∞–±  ...  –¢–µ–ª–µ—Ñ–æ–Ω_112  –ñ–∞–ª–æ–±–∞  –°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏  –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ
    1  2026-01-04  2026-01-04 00:01:12  102  –ê–≤–∞—Ä–∏—è  ...  91234567  "2. –ù–µ –ø–æ–≤–µ–∑"  "–æ—Ç—Ä–∏—Ü"  No

–í—Å–µ–≥–æ: 234,178 –∑–∞–ø–∏—Å–µ–π (4 —Ñ–∞–π–ª–∞, –Ø–Ω–≤–∞—Ä—å 2026)
- –°–õ–£–ñ–ë–ê_101: 5,574
- –°–õ–£–ñ–ë–ê_102: 158,343
- –°–õ–£–ñ–ë–ê_103: 56,923
- –°–õ–£–ñ–ë–ê_104: 13,338
"""


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #1: –£–î–ê–õ–ò–¢–¨ –ö–û–õ–û–ù–ö–£ –î–∞—Ç–∞_112
# ============================================================================
"""
–ü–æ—á–µ–º—É: –≠—Ç–∞ –∫–æ–ª–æ–Ω–∫–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç “ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç

–ë—ã–ª–æ:  25 –∫–æ–ª–æ–Ω–æ–∫
–°—Ç–∞–ª–æ: 24 –∫–æ–ª–æ–Ω–∫–∏

–ö–æ–¥:
"""
import pandas as pd

df = pd.read_excel('–°–õ–£–ñ–ë–ê_101.xlsx', sheet_name='–î–µ—Ç–∞–ª—å–Ω—ã–µ')  # 5,574 √ó 25
df = df.drop(columns=['–î–∞—Ç–∞_112'])                              # 5,574 √ó 24


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #2: –£–î–ê–õ–ò–¢–¨ –õ–ò–®–ù–ò–ï –ö–û–õ–û–ù–ö–ò (–ü–û –ù–ê–ó–í–ê–ù–ò–Ø–ú!)
# ============================================================================
"""
–ö–†–ò–¢–ò–ß–ù–û: –ù–ê–ó–í–ê–ù–ò–Ø, –∞ –Ω–µ –ü–û–ó–ò–¶–ò–ò!

–ü–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—è—é—Ç—Å—è - —ç—Ç–æ –æ—à–∏–±–∫–∞!
      ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:  df.drop([3, 4, 5, 10, 11, 12, 18, 19, 24, 25])
      ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:    df.drop(columns=['–î–∞—Ç–∞_112', '...', ...])

–£–¥–∞–ª—è–µ–º—ã–µ (8 –∫–æ–ª–æ–Ω–æ–∫):
  - “ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏ ......... —Å 3-–π –ø–æ–∑–∏—Ü–∏–∏
  - –ë—Ä–∏–≥–∞–¥–∞–≥–∞ —É–∑–∞—Ç–∏–ª–≥–∞–Ω –≤–∞“õ—Ç ..... —Å 4-–π –ø–æ–∑–∏—Ü–∏–∏
  - “ö—û–Ω“ì–∏—Ä–æ“õ —è–∫—É–Ω–ª–∞–Ω–≥–∞–Ω –≤–∞“õ—Ç .... —Å 5-–π –ø–æ–∑–∏—Ü–∏–∏
  - –°—Ç–∞—Ç—É—Å_112 ................... —Å 10-–π –ø–æ–∑–∏—Ü–∏–∏
  - “ö—û–Ω“ì–∏—Ä–æ“õ “õ–∏–ª—É–≤—á–∏ –§.–ò.–® ...... —Å 11-–π –ø–æ–∑–∏—Ü–∏–∏
  - –¢–µ–ª–µ—Ñ–æ–Ω_112 .................. —Å 12-–π –ø–æ–∑–∏—Ü–∏–∏
  - –é–∑–∏ —Ä–∞–¥ —ç—Ç–≥–∞–Ω ................ —Å 18-–π –ø–æ–∑–∏—Ü–∏–∏
  - –ï—Å—Ç—å_–∂–∞–ª–æ–±–∞ .................. —Å 19-–π –ø–æ–∑–∏—Ü–∏–∏

–°–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ (17 –∫–æ–ª–æ–Ω–æ–∫):
  - ‚Ññ ............................ –ù–û–í–ê–Ø (–¥–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
  - “ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç  –ì–õ–ê–í–ù–ê–Ø –î–ê–¢–ê
  - –°–ª—É–∂–±–∞_112 ................... ID –°–õ–£–ñ–ë–´ (101, 102, 103, 104)
  - –°–∞–±–∞–± ........................ –ü–†–ò–ß–ò–ù–ê –í–´–ó–û–í–ê
  - –ö–∞—Ä—Ç–∞_112 .................... –ö–ê–†–¢–ê
  - –ò–Ω—Ü–∏–¥–µ–Ω—Ç_112 ................. ID –ò–ù–¶–ò–î–ï–ù–¢–ê ‚Üê –ö–†–ò–¢–ò–ß–ù–û!
  - –û–ø–µ—Ä–∞—Ç–æ—Ä_112 ................. –û–ü–ï–†–ê–¢–û–†
  - –†–µ–≥–∏–æ–Ω_112 ................... –†–ï–ì–ò–û–ù ‚Üê –ö–†–ò–¢–ò–ß–ù–û! (–¥–ª—è —Å–≤–æ–¥–æ–∫)
  - –†–∞–π–æ–Ω_112 .................... –†–ê–ô–û–ù
  - –ú–∞–Ω–∑–∏–ª ........................ –ê–î–†–ï–°
  - “ö—û–Ω“ì–∏—Ä–æ“õ –∂–æ–π–∏ ................ –ú–ï–°–¢–û –ó–í–û–ù–ö–ê
  - –¢–∞–≤—Å–∏—Ñ ....................... –û–ü–ò–°–ê–ù–ò–ï
  - –¢–µ–ª–µ—Ñ–æ–Ω_–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π ...... –ù–û–ú–ï–† ‚Üê –ö–†–ò–¢–ò–ß–ù–û! (–¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–∞)
  - –ò–Ω—Ü–∏–¥–µ–Ω—Ç_112_norm ............ –ù–û–†–ú–ê–õ–ò–ó–û–í–ê–ù–ù–´–ô –ò–ù–¶–ò–î–ï–ù–¢
  - –ñ–∞–ª–æ–±–∞ ........................ –¢–ï–ö–°–¢ –ñ–ê–õ–û–ë–´ ‚Üê –ì–õ–ê–í–ù–ê–Ø (–æ—á–∏—â–µ–Ω–Ω–∞—è)
  - –°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏ ................. –°–¢–ê–¢–£–° (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
  - –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ ................. –§–õ–ê–ì (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)

–ë—ã–ª–æ: 24 –∫–æ–ª–æ–Ω–∫–∏
–°—Ç–∞–ª–æ: 16 –∫–æ–ª–æ–Ω–æ–∫
"""

DELETE_COLUMNS = [
    '–î–∞—Ç–∞_112',
    '“ö—û–Ω“ì–∏—Ä–æ“õ –¥–∞–≤–æ–º–∏–π–ª–∏–≥–∏',
    '–ë—Ä–∏–≥–∞–¥–∞–≥–∞ —É–∑–∞—Ç–∏–ª–≥–∞–Ω –≤–∞“õ—Ç',
    '“ö—û–Ω“ì–∏—Ä–æ“õ —è–∫—É–Ω–ª–∞–Ω–≥–∞–Ω –≤–∞“õ—Ç',
    '–°—Ç–∞—Ç—É—Å_112',
    '“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∏–ª—É–≤—á–∏ –§.–ò.–®',
    '–¢–µ–ª–µ—Ñ–æ–Ω_112',
    '–é–∑–∏ —Ä–∞–¥ —ç—Ç–≥–∞–Ω',
    '–ï—Å—Ç—å_–∂–∞–ª–æ–±–∞'
]

df = df.drop(columns=[col for col in DELETE_COLUMNS if col in df.columns])
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 5,574 √ó 16


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #3: –°–û–†–¢–ò–†–û–í–ö–ê –ü–û –î–ê–¢–ï (–æ—Ç —Ä–∞–Ω–Ω–∏—Ö –∫ –ø–æ–∑–¥–Ω–∏–º)
# ============================================================================
"""
–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥ –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π!

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –≤ –ø–æ—Ä—è–¥–∫–µ):
    –î–∞—Ç–∞                    –°–ª—É–∂–±–∞  –†–µ–≥–∏–æ–Ω
    2026-01-15 10:00:00     102     –§–ê–†“í–û–ù–ê
    2026-01-04 00:01:12     102     –•–û–†–ê–ó–ú
    2026-01-31 23:59:45     102     –ë–£–•–û–†–û
    2026-01-04 00:01:19     102     –ê–ù–î–ò–ñ–û–ù

–ü–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é):
    –î–∞—Ç–∞                    –°–ª—É–∂–±–∞  –†–µ–≥–∏–æ–Ω
    2026-01-04 00:01:12     102     –•–û–†–ê–ó–ú ‚Üê —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π
    2026-01-04 00:01:19     102     –ê–ù–î–ò–ñ–û–ù
    2026-01-15 10:00:00     102     –§–ê–†“í–û–ù–ê
    2026-01-31 23:59:45     102     –ë–£–•–û–†–û ‚Üê —Å–∞–º—ã–π –Ω–æ–≤—ã–π
"""

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
df['“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç'] = pd.to_datetime(
    df['“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç'], 
    errors='coerce'
)

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç —Ä–∞–Ω–Ω–∏—Ö –∫ –ø–æ–∑–¥–Ω–∏–º
df = df.sort_values(
    by='“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç', 
    ascending=True
).reset_index(drop=True)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 5,574 –∑–∞–ø–∏—Å–µ–π –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #4: –î–û–ë–ê–í–ò–¢–¨ –ö–û–õ–û–ù–ö–£ ‚Ññ (–ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏!)
# ============================================================================
"""
–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
    df['‚Ññ'] = range(1, len(df) + 1)  ‚Üê –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    df = df.sort_values('–î–∞—Ç–∞')       ‚Üê –ø–æ—Ç–æ–º —Å–æ—Ä—Ç–∏—Ä—É–µ–º (–Ω–æ–º–µ—Ä–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!)

–ü–†–ê–í–ò–õ–¨–ù–û:
    df = df.sort_values('–î–∞—Ç–∞')              ‚Üê —Å–Ω–∞—á–∞–ª–∞ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
    df.insert(0, '‚Ññ', range(1, len(df) + 1)) ‚Üê –ø–æ—Ç–æ–º –Ω—É–º–µ—Ä—É–µ–º

–†–µ–∑—É–ª—å—Ç–∞—Ç:
    ‚Ññ    –î–∞—Ç–∞                    –°–ª—É–∂–±–∞  –†–µ–≥–∏–æ–Ω
    1    2026-01-04 00:01:12     102     –•–û–†–ê–ó–ú ‚Üê –ø–µ—Ä–≤—ã–π –∑–≤–æ–Ω–æ–∫ –º–µ—Å—è—Ü–∞
    2    2026-01-04 00:01:19     102     –ê–ù–î–ò–ñ–û–ù
    3    2026-01-04 00:01:39     102     –¢–û–®–ö–ï–ù–¢
    ...
    5574 2026-01-31 23:59:45     102     –ë–£–•–û–†–û ‚Üê –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–≤–æ–Ω–æ–∫ –º–µ—Å—è—Ü–∞
"""

df.insert(0, '‚Ññ', range(1, len(df) + 1))
# –°—Ç–∞–ª–æ: 5,574 √ó 17 (–¥–æ–±–∞–≤–∏–ª–∞—Å—å –∫–æ–ª–æ–Ω–∫–∞ –≤ –Ω–∞—á–∞–ª–æ)


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #5: –£–î–ê–õ–ò–¢–¨ –ü–†–ï–§–ò–ö–°–´ 1./2./3./4. –ò–ó –ñ–ê–õ–û–ë
# ============================================================================
"""
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –∂–∞–ª–æ–± (–ø–ª–æ—Ö–æ):
    "1. –ù–µ –ø–æ–≤–µ–∑ –º–∞—à–∏–Ω—É"
    "2. –ù–µ –ø–æ–≤–µ–∑ –º–∞—à–∏–Ω—É –∏ –µ—â–µ —á–µ–≥–æ-—Ç–æ"
    "3. –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏"
    "4. –í—Å—ë –ø–ª–æ—Ö–æ"

–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –∂–∞–ª–æ–± (—Ö–æ—Ä–æ—à–æ):
    "–ù–µ –ø–æ–≤–µ–∑ –º–∞—à–∏–Ω—É"
    "–ù–µ –ø–æ–≤–µ–∑ –º–∞—à–∏–Ω—É –∏ –µ—â–µ —á–µ–≥–æ-—Ç–æ"
    "–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏"
    "–í—Å—ë –ø–ª–æ—Ö–æ"

–õ–æ–≥–∏–∫–∞:
  - –ò—â–µ–º –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏ (^\s*)
  - –ò—â–µ–º —Ü–∏—Ñ—Ä—É 1-4 ([1-4])
  - –ò—â–µ–º —Ç–æ—á–∫—É (\.)
  - –ò—â–µ–º –ø—Ä–æ–±–µ–ª (\s*)
  - –£–¥–∞–ª—è–µ–º –≤—Å—ë —ç—Ç–æ
"""

import re

def clean_complaint_prefix(text):
    if pd.isna(text):
        return text
    text = str(text)
    # Regex: ^ (–Ω–∞—á–∞–ª–æ) \s* (–ø—Ä–æ–±–µ–ª—ã) [1-4] (—Ü–∏—Ñ—Ä–∞) \. (—Ç–æ—á–∫–∞) \s* (–ø—Ä–æ–±–µ–ª—ã)
    text = re.sub(r'^\s*[1-4]\.\s*', '', text)
    return text

df['–ñ–∞–ª–æ–±–∞'] = df['–ñ–∞–ª–æ–±–∞'].apply(clean_complaint_prefix)


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #6: –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø –°–¢–ê–¢–£–°–û–í
# ============================================================================
"""
–ò—Å—Ö–æ–¥–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞: –°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏

–í—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä—ã):
    "–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π"
    "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π"
    "–Ω–µ —É–¥–∞–ª–æ—Å—å –¥–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è"
    "–Ω–µ–¥–æ–∑–≤–æ–Ω"
    "–Ω–µ –æ—Ç–≤–µ—Ç"
    "–∑–∞–Ω—è—Ç–æ"
    "—Å–±—Ä–æ—Å –≤—ã–∑–æ–≤–∞"
    "–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞"
    None / –ø—É—Å—Ç–æ

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏):
    ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ ......... text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç "–ø–æ–ª–æ–∂"
    ‚ùå –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ......... text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç "–æ—Ç—Ä–∏—Ü" –ò –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç "–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞"
    üìû –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å ........ text.lower() —Å–æ–¥–µ—Ä–∂–∏—Ç –ª—é–±–æ–µ –∏–∑: 
                              ["–Ω–µ —É–¥–∞–ª–æ—Å—å", "–Ω–µ–¥–æ–∑–≤–æ–Ω", "–Ω–µ –¥–æ–∑–≤–æ–Ω", "–Ω–µ –æ—Ç–≤–µ—Ç", "–∑–∞–Ω—è—Ç", "—Å–±—Ä–æ—Å"]
    ‚ùì –ü—Ä–æ—á–µ–µ ................ –æ—Å—Ç–∞–ª—å–Ω–æ–µ
    üö´ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ ............ –ø—É—Å—Ç–æ/None

–í–ê–ñ–ù–û: –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤–∞–∂–µ–Ω! –ü—Ä–æ–≤–µ—Ä—è–µ–º "–æ—Ç—Ä–∏—Ü" –¥–æ "–Ω–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å"
"""

def classify_status(val):
    """–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å –≤ –æ–¥–Ω—É –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
    if pd.isna(val):
        return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
    
    text = str(val).strip().lower()
    if not text:
        return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –ø–æ—Ä—è–¥–∫–µ –ü–†–ò–û–†–ò–¢–ï–¢–ê
    if '–ø–æ–ª–æ–∂' in text:
        return '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ'
    
    # –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï, –Ω–æ –ù–ï "–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞"!!!
    if '–æ—Ç—Ä–∏—Ü' in text and '–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞' not in text:
        return '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ'
    
    # –ù–ï –î–û–ó–í–û–ù–ò–õ–ò–°–¨
    patterns = ['–Ω–µ —É–¥–∞–ª–æ—Å—å', '–Ω–µ–¥–æ–∑–≤–æ–Ω', '–Ω–µ –¥–æ–∑–≤–æ–Ω', '–Ω–µ –æ—Ç–≤–µ—Ç', '–∑–∞–Ω—è—Ç', '—Å–±—Ä–æ—Å']
    if any(pat in text for pat in patterns):
        return '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å'
    
    # –ó–ê–Ø–í–ö–ê –ó–ê–ö–†–´–¢–ê –∏–ª–∏ –¥—Ä—É–≥–∏–µ –Ω–µ–≥–∞—Ç–∏–≤—ã
    if '–æ—Ç—Ä–∏—Ü' in text or '–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞' in text:
        return '–ü—Ä–æ—á–µ–µ'
    
    return '–ü—Ä–æ—á–µ–µ'


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
print(classify_status('–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π'))           # ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
print(classify_status('–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π'))            # ‚ùå –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ
print(classify_status('–Ω–µ —É–¥–∞–ª–æ—Å—å –¥–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è'))   # üìû –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å
print(classify_status('–∑–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞'))           # ‚ùì –ü—Ä–æ—á–µ–µ
print(classify_status(None))                       # üö´ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #7: –õ–ò–¢ "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã"
# ============================================================================
"""
–¢–æ–ª—å–∫–æ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ"

–í—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 5,574 –∑–∞–ø–∏—Å–µ–π (–≤—Å–µ)

–§–∏–ª—å—Ç—Ä:
    df[df['–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏'].apply(
        lambda x: classify_status(x) == '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ'
    )]

–†–µ–∑—É–ª—å—Ç–∞—Ç: 89 –∑–∞–ø–∏—Å–µ–π (–°–õ–£–ñ–ë–ê_101)
    - –°–õ–£–ñ–ë–ê_102: 9,818 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
    - –°–õ–£–ñ–ë–ê_103: 804 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
    - –°–õ–£–ñ–ë–ê_104: 1,347 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö

–≠—Ç–æ —Ç–æ, —á—Ç–æ –ø–æ–ø–∞–¥–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã"
"""

df_negative = df[
    df['–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏'].apply(
        lambda x: classify_status(x) == '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ'
    )
].copy()

# –ü–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –ø–µ—Ä–µ–Ω–æ–º–µ—Ä—É–µ–º
df_negative = df_negative.reset_index(drop=True)
df_negative.insert(0, '‚Ññ', range(1, len(df_negative) + 1))

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 89 √ó 17 (–°–õ–£–ñ–ë–ê_101)


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #8: –õ–ò–°–¢ "–ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º" - –°–í–û–î–ö–ê
# ============================================================================
"""
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
    –†–µ–≥–∏–æ–Ω_112          | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∂–∞–ª–æ–± | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ | –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å | –í—Å–µ–≥–æ
    –§–ê–†“í–û–ù–ê –í–ò–õ–û–Ø–¢–ò     | 234              | 23            | 45             | 1,234
    –•–û–†–ê–ó–ú –í–ò–õ–û–Ø–¢–ò      | 156              | 12            | 34             | 890
    –¢–û–®–ö–ï–ù–¢             | 345              | 34            | 56             | 1,567
    ...

–õ–æ–≥–∏–∫–∞:
    1. –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –†–µ–≥–∏–æ–Ω_112
    2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ —Å—á–∏—Ç–∞–µ–º:
       - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∂–∞–ª–æ–± = COUNT(–ñ–∞–ª–æ–±–∞ IS NOT NULL)
       - –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ = COUNT(classify_status() == '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ')
       - –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å = COUNT(classify_status() == '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å')
       - –í—Å–µ–≥–æ = COUNT(–≤—Å–µ –∑–∞–ø–∏—Å–∏)
"""

import pandas as pd

regional_data = []
regions = df['–†–µ–≥–∏–æ–Ω_112'].dropna().unique()

for region in sorted(regions):
    region_df = df[df['–†–µ–≥–∏–æ–Ω_112'] == region]
    
    # –°—á–∏—Ç–∞–µ–º –∂–∞–ª–æ–±—ã
    total_complaints = region_df['–ñ–∞–ª–æ–±–∞'].notna().sum()
    positive_count = region_df['–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏'].apply(
        lambda x: classify_status(x) == '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ'
    ).sum()
    no_reach_count = region_df['–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏'].apply(
        lambda x: classify_status(x) == '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å'
    ).sum()
    
    regional_data.append({
        '–†–µ–≥–∏–æ–Ω_112': region,
        '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∂–∞–ª–æ–±': total_complaints,
        '–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ': positive_count,
        '–ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å': no_reach_count,
        '–í—Å–µ–≥–æ': len(region_df)
    })

df_regional = pd.DataFrame(regional_data)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 14 —Å—Ç—Ä–æ–∫ (—Ä–µ–≥–∏–æ–Ω–æ–≤) √ó 5 –∫–æ–ª–æ–Ω–æ–∫


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #9: –õ–ò–°–¢ "–†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã" - PIVOT –¢–ê–ë–õ–ò–¶–ê
# ============================================================================
"""
PIVOT —Ç–∞–±–ª–∏—Ü–∞: —Ä–µ–≥–∏–æ–Ω—ã –≤ —Å—Ç—Ä–æ–∫–∞—Ö, —Å—Ç–∞—Ç—É—Å—ã –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö

–ò—Å—Ö–æ–¥–Ω—ã–µ:
    –†–µ–≥–∏–æ–Ω_112      | –°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏
    –§–ê–†“í–û–ù–ê         | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
    –§–ê–†“í–û–ù–ê         | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ
    –§–ê–†“í–û–ù–ê         | –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å
    –•–û–†–ê–ó–ú          | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
    ...

PIVOT —Ç–∞–±–ª–∏—Ü–∞:
    –†–µ–≥–∏–æ–Ω_112      | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ | –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å | –ü—Ä–æ—á–µ–µ | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ
    –§–ê–†“í–û–ù–ê         | 234           | 567           | 1,234          | 145    | 2
    –•–û–†–ê–ó–ú          | 156           | 423           | 1,567          | 98     | 1
    ...

–ö–æ–¥:
"""

pivot = df.groupby(['–†–µ–≥–∏–æ–Ω_112', '–°—Ç–∞—Ç—É—Å_—Å–≤—è–∑–∏']).size().unstack(fill_value=0)
pivot = pivot.reset_index()

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 14 —Ä–µ–≥–∏–æ–Ω–æ–≤ √ó 6 –∫–æ–ª–æ–Ω–æ–∫ (—Ä–µ–≥–∏–æ–Ω + 5 —Å—Ç–∞—Ç—É—Å–æ–≤)


# ============================================================================
# –¢–†–ï–ë–û–í–ê–ù–ò–ï #10: –õ–ò–°–¢ "–ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏"
# ============================================================================
"""
–ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, –ù–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å)

–≠—Ç–æ –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ü—Ä–æ—á–µ–µ" –∏–ª–∏ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"

–õ–æ–≥–∏–∫–∞:
    - –ë–µ—Ä–µ–º –≤—Å–µ DF
    - –ò—Å–∫–ª—é—á–∞–µ–º —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ (–∏–Ω–¥–µ–∫—Å—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –ª–∏—Å—Ç–æ–≤)
    - –û—Å—Ç–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω –∑–∞–ø–∏—Å–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
"""


# ============================================================================
# –ò–¢–û–ì–û–í–´–ô –§–ê–ô–õ - –°–¢–†–£–ö–¢–£–†–ê (5 –ª–∏—Å—Ç–æ–≤)
# ============================================================================
"""
–°–õ–£–ñ–ë–ê_101_–ò–ù–¶–ò–î–ï–ù–¢–´_2026-02-04_07-36-15.xlsx
‚îú‚îÄ‚îÄ –õ–∏—Å—Ç 1: "–î–µ—Ç–∞–ª—å–Ω—ã–µ" (5,574 √ó 17)
‚îÇ   ‚îî‚îÄ‚îÄ –í—Å–µ –∑–∞–ø–∏—Å–∏ —Å–æ –≤—Å–µ–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ, —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π
‚îÇ
‚îú‚îÄ‚îÄ –õ–∏—Å—Ç 2: "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã" (89 √ó 17)
‚îÇ   ‚îî‚îÄ‚îÄ –¢–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ"
‚îÇ
‚îú‚îÄ‚îÄ –õ–∏—Å—Ç 3: "–ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º" (14 √ó 5)
‚îÇ   ‚îî‚îÄ‚îÄ –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º:
‚îÇ       –†–µ–≥–∏–æ–Ω | –ñ–∞–ª–æ–± | –ü–æ–ª–æ–∂–∏—Ç | –ù–µ –¥–æ–∑–≤–æ–Ω | –í—Å–µ–≥–æ | (pivot)
‚îÇ
‚îú‚îÄ‚îÄ –õ–∏—Å—Ç 4: "–†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã" (14 √ó 6)
‚îÇ   ‚îî‚îÄ‚îÄ PIVOT: —Ä–µ–≥–∏–æ–Ω—ã √ó —Å—Ç–∞—Ç—É—Å—ã
‚îÇ       –†–µ–≥–∏–æ–Ω | –ü–æ–ª–æ–∂–∏—Ç | –û—Ç—Ä–∏—Ü–∞—Ç | –ù.–¥–æ–∑–≤ | –ü—Ä–æ—á–µ–µ | –ù–µ—ã–∑–Ω
‚îÇ
‚îî‚îÄ‚îÄ –õ–∏—Å—Ç 5: "–ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏" (? √ó 17)
    ‚îî‚îÄ‚îÄ –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (—Å—Ç–∞—Ç—É—Å—ã –ü—Ä–æ—á–µ–µ/–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ)
"""


# ============================================================================
# –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –í–°–ï–• –õ–ò–°–¢–û–í
# ============================================================================
"""
–ö–∞–∂–¥—ã–π –ª–∏—Å—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å:
    ‚úÖ –ì—Ä–∞–Ω–∏—Ü—ã (thin border)
    ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ—Ä—ã–π —Å –∂–∏—Ä–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
    ‚úÖ –ê–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä
    ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
    ‚úÖ –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (left, vertical center, wrap)
"""


# ============================================================================
# –ü–û–õ–ù–´–ô –¶–ò–ö–õ –ö–û–î
# ============================================================================
"""
# 1. –ó–∞–≥—Ä—É–∑–∫–∞
df = pd.read_excel('–°–õ–£–ñ–ë–ê_101.xlsx', sheet_name='–î–µ—Ç–∞–ª—å–Ω—ã–µ')  # 5,574 √ó 25

# 2. –£–¥–∞–ª–µ–Ω–∏–µ –î–∞—Ç–∞_112
df = df.drop(columns=['–î–∞—Ç–∞_112'])  # 5,574 √ó 24

# 3. –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –∫–æ–ª–æ–Ω–æ–∫ (–ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º!)
DELETE_COLUMNS = [...]
df = df.drop(columns=[col for col in DELETE_COLUMNS if col in df.columns])  # 5,574 √ó 16

# 4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
df['“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç'] = pd.to_datetime(...)
df = df.sort_values(by='“ö—û–Ω“ì–∏—Ä–æ“õ “õ–∞–±—É–ª “õ–∏–ª–∏–Ω–≥–∞–Ω –≤–∞“õ—Ç', ascending=True).reset_index(drop=True)

# 5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω—É–º–µ—Ä–∞—Ü–∏–∏
df.insert(0, '‚Ññ', range(1, len(df) + 1))  # 5,574 √ó 17

# 6. –û—á–∏—Å—Ç–∫–∞ –∂–∞–ª–æ–±
df['–ñ–∞–ª–æ–±–∞'] = df['–ñ–∞–ª–æ–±–∞'].apply(clean_complaint_prefix)

# 7-10. –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤
# –õ–∏—Å—Ç 1: –î–µ—Ç–∞–ª—å–Ω—ã–µ (–≤–µ—Å—å DF)
# –õ–∏—Å—Ç 2: –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ_–∏_–∂–∞–ª–æ–±—ã (—Ñ–∏–ª—å—Ç—Ä –æ—Ç—Ä–∏—Ü)
# –õ–∏—Å—Ç 3: –ñ–∞–ª–æ–±—ã_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º (groupby + count)
# –õ–∏—Å—Ç 4: –†–µ–≥–∏–æ–Ω—ã_–∏_–∂–∞–ª–æ–±—ã (pivot)
# –õ–∏—Å—Ç 5: –ù–µ_–Ω–∞–π–¥–µ–Ω–Ω—ã–µ_–∑–∞—è–≤–∫–∏ (–æ—Å—Ç–∞–ª—å–Ω–æ–µ)

# 11. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
# –ì—Ä–∞–Ω–∏—Ü—ã, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä, —à–∏—Ä–∏–Ω—ã

# 12. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
wb.save('–°–õ–£–ñ–ë–ê_101.xlsx')
"""


# ============================================================================
# –°–¢–ê–¢–ò–°–¢–ò–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê (–Ø–Ω–≤–∞—Ä—å 2026)
# ============================================================================
"""
–°–õ–£–ñ–ë–ê_101 (–≤—Å–µ–≥–æ 5,574):
  ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ: 5,574 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: 89 (1.6%)
  ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤: 14
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –û–ë–†–ê–ë–û–¢–ê–ù–û

–°–õ–£–ñ–ë–ê_102 (–≤—Å–µ–≥–æ 158,343):
  ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ: 158,343 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: 9,818 (6.2%)
  ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤: 14
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –û–ë–†–ê–ë–û–¢–ê–ù–û

–°–õ–£–ñ–ë–ê_103 (–≤—Å–µ–≥–æ 56,923):
  ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ: 56,923 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: 804 (1.4%)
  ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤: 14
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –û–ë–†–ê–ë–û–¢–ê–ù–û

–°–õ–£–ñ–ë–ê_104 (–≤—Å–µ–≥–æ 13,338):
  ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ: 13,338 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: 1,347 (10.1%)
  ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤: 10
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –û–ë–†–ê–ë–û–¢–ê–ù–û

–û–ë–©–ò–ô_–û–¢–ß–ï–¢ (–≤—Å–µ–≥–æ 234,178):
  ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ: 234,178 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: 12,058 (5.1%)
  ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤: 14
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –û–ë–†–ê–ë–û–¢–ê–ù–û

–ü–ê–ü–ö–ê: –°–ª—É–∂–±—ã –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∑–∞ –Ø–Ω–≤–∞—Ä—å –º–µ—Å—è—Ü 2026 –≥–æ–¥
–ü–û–î–ü–ê–ü–ö–ê: –¢–û–õ–¨–ö–û_–û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï
  ‚Ä¢ 4 —Ñ–∞–π–ª–∞ —Å –¢–û–õ–¨–ö–û –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∂–∞–ª–æ–±–∞–º–∏
  ‚Ä¢ –í—Å–µ–≥–æ 12,058 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ‚úÖ –°–û–ó–î–ê–ù–ê
"""

# ============================================================================
# –ì–û–¢–û–í–û! üéâ
# ============================================================================
